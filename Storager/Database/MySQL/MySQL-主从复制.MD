MySQL 主从复制
------------------------
### 概念
建立一个（或多个）与生产环境数据库一样的数据库，配置主从，正在使用的准实时数据库作为主库，新建的库作为从库，从库从主库复制数据，保持数据同步。
### 背景
 - 业务发展，I/O访问频率过高，单库难以支撑。
 - 数据库故障，传统方案人工定期备份，效率低，数据丢失严重，恢复慢。
 - 在业务复杂的系统中，有这么一个情景，有一句sql语句需要锁表，导致暂时不能使用读的服务，那么就很影响运行中的业务，使用主从复制，让主库负责写，从库负责读，这样，即使主库出现了锁表的情景，通过读从库也可以保证业务的正常运作。
### 作用
 - 实时备份
 - 故障切换，高可用
 - 读写分离，缓解单节点压力，高性能
### 原理
 - 主节点将DataChange写入BinLog
 - 从节点定期探测主节点的BinLog
 - 若从节点读到主节点DataChange
   - 主节点为每个I/O线程启动一个dump线程，向从节点发送DataChange数据
   - 从节点收到主节点的DataChange数据，从节点的I/O线程，将数据写入RelayLog
 - 从节点SQL线程定期检查RelayLog，若有更新，分析并进行Replay，将数据变更原样写入，同时记录自己的BinLog

### 方案
 - Replication
 - PXC
#### 形式
 - 一主一从

![一主一从](https://images.gitee.com/uploads/images/2020/0704/112136_81631e35_536895.png "一主一从.png")
 - 一主多从
 - 多主一从
 - 互为主从
 - 级联复制

### 参考

